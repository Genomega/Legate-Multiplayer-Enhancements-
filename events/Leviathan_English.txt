
namespace = women_history_events
namespace = anjou_england


country_event = {
	id = women_history_events.27
	title = women_history_events.27.t
	desc = women_history_events.27.d
	picture = wihgfx_FEMALE_RULER_eventPicture

	major = yes
	
	trigger = {
		OR = {
			tag = ENG
			tag = GBR
		}
		NOT = {
			is_year = 1500
		}
		is_female = no
		has_regency = no
		is_lesser_in_union = no
		government = monarchy
		NOT = {
			has_global_flag = wih_margaretofanjou_flag
		}
	}
	
	mean_time_to_happen = {
		months = 3
	}
	
	immediate = {
		hidden_effect = {
			set_global_flag = wih_margaretofanjou_flag
		}
	}
	option = {
		name = women_history_events.27.c
		define_ruler = {
			name = "Margaret"
			dynasty = "d'Anjou"
			culture = cosmopolitan_french
			fixed = yes
			adm = 4
			dip = 4
			mil = 3
			female = yes
			birth_date = 1430.9.25
			claim = 50
		}
		hidden_effect = {
			add_ruler_personality = righteous_personality
			add_ruler_personality = silver_tongue_personality
			add_ruler_personality = lawgiver_personality
			define_consort = {
				name = "Henry VI"
				dynasty = "Lancaster"
				culture = english
				fixed = yes
				adm = 0
				dip = 1
				mil = 0
				birth_date = 1421.12.6
			}
			#clear_scripted_personalities = yes
			add_queen_personality = infertile_personality
			add_disaster_progress = {
				disaster = war_of_the_roses
				value = 15
			}			
		}	
		custom_tooltip = war_of_the_roses_anjou.tt
		if = {
			limit = {
				has_states_general_mechanic = yes
			}
			change_statists_vs_orangists = 1
		}
		if = {
			limit = {
				has_dlc = "Rights of Man" 
			}
			hidden_effect = { 
				
			}	
		}
	}
	option = {
		name = women_history_events.27.a
		trigger = {
			has_dlc = "Rights of Man"
			#has_government_attribute = queen
		}
		add_adm_power = 50
		add_dip_power = 50
		add_mil_power = 50
		add_meritocracy_effect = yes
		#define_consort = {
		#	name = "Margaret"
		#	dynasty = "d'Anjou"
		#	culture = cosmopolitan_french
		#	fixed = yes
		#	adm = 4
		#	dip = 4
		#	mil = 3
		#	female = yes
		#	birth_date = 1430.9.25
		#}
		add_ruler_modifier = {
			name = margaret_of_anjou_regency
			duration = -1
		}	
		hidden_effect = {
			add_queen_personality_ancestor = { key = righteous }
		}
	}
}

# Margaret seeks to lead troops
country_event = {
	id = anjou_england.1
	title = anjou_england.1.t
	desc = anjou_england.1.d
	picture = wihgfx_FEMALE_GENERAL_eventPicture

	trigger = {
		OR = {
			tag = ENG
			tag = GBR
		}
		NOT = {
			is_year = 1500
		}
		has_country_flag = support_blue_rose
		NOT = { has_country_flag = margaret_leader_decision }
		has_disaster = war_of_the_roses
		has_ruler = "Margaret"
		dynasty = d'Anjou
		government = monarchy
	}
	
	mean_time_to_happen = {
		months = 10
	}

	
	immediate = {
		hidden_effect = {
			set_country_flag = margaret_leader_decision
			add_country_modifier = {
				name = "female_general_check_eng"
				duration = -1
				hidden = yes
			}	
		}	
	}
	option = {
		name = anjou_england.1.a
		custom_tooltip = margaret_leading_warning.tt
		custom_tooltip = enables_female_generals_eng.tt
		define_ruler_to_general = {
			fire = 2
			shock = 4
			manuever = 4
			siege = 1
		}
		add_ruler_modifier = {
			name = "the_warrior_queen_eng"
			duration = -1
		}	
		remove_ruler_personality = lawgiver_personality
		add_ruler_personality = inspiring_leader_personality
	}
	option = {
		name = anjou_england.1.b
		add_prestige = 10
		add_legitimacy = 10
		add_ruler_modifier = {
			name = "anjou_ruler_legitimate"
			duration = 7300
		}
		hidden_effect = {
			remove_country_modifier = female_general_check_eng
		}	
	}	
}

country_event = { # Provencal Retinue
	id = anjou_england.2
	title = anjou_england.2.t
	desc = anjou_england.2.d
	picture = CONQUEST_eventPicture

	trigger = {
		NOT = { has_country_flag = anjou_provencal_support }
		NOT = {
			is_year = 1500
		}
		OR = {
			tag = ENG
			tag = GBR
		}		
		has_country_flag = support_blue_rose
		has_disaster = war_of_the_roses
		dynasty = d'Anjou
		government = monarchy
	}
	
	mean_time_to_happen = {
		months = 6
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = anjou_provencal_support
		}
	}	
	
	option = {
		name = anjou_england.2.a
		add_treasury = 100
		add_manpower = 7.5
		create_general = { 
			tradition = 80
			culture = occitain
		}
		create_general = { 
			tradition = 60
			culture = occitain
		}		
	}
}

country_event = { # Birth of Edward of Westminster
	id = anjou_england.3
	title = anjou_england.3.t
	desc = anjou_england.3.d
	picture = NEW_HEIR_eventPicture

	fire_only_once = yes
	
	trigger = {
		has_heir = no
		NOT = {
			is_year = 1500
		}
		OR = {
			tag = ENG
			tag = GBR
		}		
		has_country_flag = support_blue_rose
		has_disaster = war_of_the_roses
		dynasty = d'Anjou
		government = monarchy
	}
	
	mean_time_to_happen = {
		months = 2
	}	
	
	option = {
		name = anjou_england.3.a
		ai_chance = { factor = 25 }
		add_legitimacy = 10
		define_heir = {
			name = "Edward"
			dynasty = "Lancaster"
			culture = english
			age = 0
			adm = 3
			dip = 3
			mil = 5
			claim = 95
			male = yes
			fixed = yes
			no_consort_with_heir = yes
		}
	}
	option = {
		name = anjou_england.3.b
		ai_chance = { factor = 75 }
		add_power_projection = {
			type = mission_rewards_power_projection
			amount = 10
		}		
		define_heir = {
			name = "Edward"
			dynasty = "d'Anjou"
			culture = english
			age = 0
			adm = 3
			dip = 3
			mil = 5
			claim = 50
			male = yes
			fixed = yes
			no_consort_with_heir = yes
		}		
	}	
}


country_event = { # Irish conquest
	id = anjou_england.401
	title = anjou_england.401.t
	desc = anjou_england.401.desc
	picture = GENERALS_DISCUSSING_eventPicture

	#fire_only_once = yes
	is_triggered_only = yes
	
	option = {
		name = anjou_england.401.a
		ai_chance = { factor = 75 }
		custom_tooltip = disables_ireland_formation.tt
		set_country_flag = eng_direct_irish_conquest	
		inherit = MTH
		add_country_modifier = {
			name = "the_irish_campaign"
			duration = 3650
		}		
		munster_area = {
			add_permanent_claim = ROOT
		}
		connacht_area = {
			add_permanent_claim = ROOT
		}
		ulster_area = {
			add_permanent_claim = ROOT
		}
		leinster_area = {
			add_core = ROOT
		}
	}
	option = {
		name = anjou_england.401.b
		ai_chance = { factor = 25 }
		highlight = yes
		set_country_flag = eng_puppet_irish_conquest
		custom_tooltip = enables_ireland_formation.tt
		MTH = {
			add_country_modifier = {
				name = "english_rule_asserted"
				duration = 9125
			}
		}			
		munster_area = {
			add_core = MTH
		}
		connacht_area = {
			add_core = MTH
		}
		ulster_area = {
			add_core = MTH
		}
		leinster_area = {
			add_core = MTH
		}	
	}	
}


country_event = { # Irish conquest
	id = anjou_england.402
	title = anjou_england.402.t
	desc = anjou_england.402.desc
	picture = CONQUEST_eventPicture

	#fire_only_once = yes
	is_triggered_only = yes
	
	option = { # King of England and Ireland
		name = anjou_england.402.a
		ai_chance = { factor = 75 }
		trigger = {
			has_country_flag = eng_puppet_irish_conquest
		}	
		custom_tooltip = forming_britain_reward.tt
		add_power_projection = {
			type = mission_rewards_power_projection
			amount = 20
		}
		munster_area = {
			cede_province = MTH
		}
		connacht_area = {
			cede_province = MTH
		}
		ulster_area = {
			cede_province = MTH
		}
		leinster_area = {
			cede_province = MTH
		}
		create_union = MTH
		set_country_flag = ireland_inherit_yes
		MTH = {
			add_liberty_desire = 25
			set_government_rank = 2
			change_tag = IRE
			swap_free_idea_group = yes
		}	
	}
	
	option = { # Vassal Kingdom of Ireland
		name = anjou_england.402.b
		ai_chance = { factor = 75 }
		add_legitimacy = 25
		add_prestige = 25
			trigger = {
			has_country_flag = eng_puppet_irish_conquest
		}		
		munster_area = {
			cede_province = MTH
		}
		connacht_area = {
			cede_province = MTH
		}
		ulster_area = {
			cede_province = MTH
		}
		leinster_area = {
			cede_province = MTH
		}
		MTH = {
			change_tag = IRE
			swap_free_idea_group = yes
			set_government_rank = 2
		}	
		add_historical_friend = IRE
		IRE = {
			add_historical_friend = ENG
			add_historical_friend = GBR
		}	
	}	
	option = { # In time they will learn to love me
		name = anjou_england.402.c
		ai_chance = { factor = 25 }
		trigger = {
			has_country_flag = eng_direct_irish_conquest
		}			
		add_adm_power = 100
		add_dip_power = 100
		add_country_modifier = {
			name = "ireland_brought_to_the_fold"
			duration = -1
		}	
		add_accepted_culture = irish
		munster_area = {
			add_nationalism = -3
		}
		connacht_area = {
			add_nationalism = -3
		}
		ulster_area = {
			add_nationalism = -3
		}
		leinster_area = {
			add_nationalism = -3
		}		
	}	
	option = { # Execute them all!
		name = anjou_england.402.d
		ai_chance = { factor = 25 }
		trigger = {
			has_country_flag = eng_direct_irish_conquest
		}		
		add_treasury = 200
		munster_area = {
			add_devastation = 50
			add_nationalism = -50
			add_permanent_province_modifier = {
				name = "clan_brutalizied"
				duration = 18250
			}	
		}
		connacht_area = {
			add_devastation = 50
			add_nationalism = -50
			add_permanent_province_modifier = {
				name = "clan_brutalizied"
				duration = 18250
			}				
		}
		ulster_area = {
			add_devastation = 50
			add_nationalism = -50
			add_permanent_province_modifier = {
				name = "clan_brutalizied"
				duration = 18250
			}				
		}
		leinster_area = {
			add_devastation = 50
			add_nationalism = -50
			add_permanent_province_modifier = {
				name = "clan_brutalizied"
				duration = 18250
			}				
		}	
	}	
}